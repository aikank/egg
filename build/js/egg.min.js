/*! jp.mi73.egg 2014-01-24 */
!function(a,b,c,d){"use strict";d.Object3D._matrixAux=new d.Matrix4,d.Object3D.prototype.rotateAroundWorldAxis=function(a,b){d.Object3D._matrixAux.makeRotationAxis(a,b),this.matrix.multiplyMatrices(d.Object3D._matrixAux,this.matrix),d.Object3D._matrixAux.extractRotation(this.matrix),this.rotation.setEulerFromRotationMatrix(d.Object3D._matrixAux,this.eulerOrder),this.position.getPositionFromMatrix(this.matrix)},d.Object3D.prototype.rotateAroundWorldAxisX=function(a){this._vector.set(1,0,0),this.rotateAroundWorldAxis(this._vector,a)},d.Object3D.prototype.rotateAroundWorldAxisY=function(a){this._vector.set(0,1,0),this.rotateAroundWorldAxis(this._vector,a)},d.Object3D.prototype.rotateAroundWorldAxisZ=function(a){this._vector.set(0,0,1),this.rotateAroundWorldAxis(this._vector,a)};var e=function(){this.renderer=null,this.camera=null,this.init=function(){function c(){e.egg.position.z=0,B.update(),e.renderer.render(e.scene,e.camera),requestAnimationFrame(c)}var e=this;this.renderer=new d.WebGLRenderer,this.renderer.setSize(a.innerWidth,a.innerHeight),this.renderer.shadowMapEnabled=!0,b.getElementById("canvas-frame").appendChild(this.renderer.domElement);var f=60,g=window.innerWidth/window.innerHeight,h=.1,i=1e4;this.camera=new d.PerspectiveCamera(f,g,h,i),this.camera.position=new d.Vector3(170,0,10),this.camera.up=new d.Vector3(1,0,1),this.scene=new d.Scene,this.scene.add(this.camera);var j=new d.MeshPhongMaterial({color:16777215,specular:16777215,shininess:1e3,shading:d.SmoothShading}),k=new d.PlaneGeometry(1e4,1e5,200,200);this.ground=new d.Mesh(k,j),this.ground.position.z=-40,this.ground.receiveShadow=!0,this.scene.add(this.ground);for(var l,m,n=[],o=40,p=new d.Geometry,q=0;180>=q;q++)l=Math.PI*q/180,m=new d.Vector3(0,o*(.72+.08*Math.cos(l))*Math.sin(l),-o*Math.cos(l)),n.push(m),p.vertices.push(m);var r=new d.LineBasicMaterial({color:16756849,linewidth:3});this.eggLine=new d.Line(p,r,d.LineStrip),this.eggGeometry=new d.LatheGeometry(n,100),this.eggMaterial=new d.MeshPhongMaterial({color:16756849,shininess:1,map:d.ImageUtils.loadTexture("img/egg.jpg"),shading:d.SmoothShading}),this.egg=new d.Mesh(this.eggGeometry,this.eggMaterial),this.egg.castShadow=!0,this.scene.add(this.egg),this.dotsPoints=new d.Object3D;var s=new d.MeshBasicMaterial({color:16777215,transparent:!1});this.scene.add(this.dotsPoints);var t=0;this.drawEggPoint=function(){if(t%5===0){var a=new d.SphereGeometry(.5),b=new d.Mesh(a,s);b.position=n[t],e.dotsPoints.add(b),e.renderer.render(e.scene,e.camera)}t++,180>=t&&requestAnimationFrame(e.drawEggPoint)};var u=0,v=0;this.spinCurve=function(){e.dotsPoints.rotateZ(v),e.renderer.render(e.scene,e.camera),u++,1>v&&(v+=.001),requestAnimationFrame(e.spinCurve)};var w=new d.PointLight(16777215);w.position.set(700,700,700),w.shadowCameraVisible=!0,w.castShadow=!0,this.scene.add(w);var x=new d.SpotLight(16777215);x.position.set(700,700,700),x.target.position.set(0,0,0),x.shadowCameraVisible=!0,x.castShadow=!0;var y=new d.AmbientLight(2105376);this.scene.add(y);var z=new d.DirectionalLight(4210752);z.position.set(1,-1,1).normalize(),z.shadowCameraVisible=!0,z.castShadow=!0;var A=new d.DirectionalLight(4210752);A.position.set(1,1,1).normalize(),A.shadowCameraVisible=!0,A.castShadow=!0;var B=new d.TrackballControls(this.camera);B.keys=[65,83,68],B.noRotate=!1,B.noZoom=!1,B.noPan=!1,this.renderer.render(this.scene,this.camera);c()}};e.prototype={},"undefined"==typeof a.jp&&(a.jp={}),"undefined"==typeof a.jp.mi73&&(a.jp.mi73={}),a.jp.mi73.Egg=new e}(window,document,jQuery,THREE),window.jp.mi73.Egg.init();var e=window.jp.mi73.Egg;